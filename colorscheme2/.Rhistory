load("D:/R_package/colorscheme2/data/chemi_aa_coldf.rda")
chemi_aa_coldf
aa<-chemi_aa_coldf
aa
chemistry<-c("aromatic","acidic","basic","nonpolar","polar","none")
aa[,3]<-aa[,2]
aa
aa[,2]
chemi_aa_coldf[,3]<-aa$aa_color
chemi_aa_coldf
names(aa)
chemi_aa_coldf[,2]<-aa[,1]
chemi_aa_coldf
chemi_aa_coldf[,3]<-chemistry
chemi_aa_coldf
chemi_aa_coldf[,3]<-aa[,2]
chemi_aa_coldf
chemi_aa_coldf[,1]<-chemistry
chemi_aa_coldf
names(aa)[1:2]
names(chemi_aa_coldf)[2:3]<-names(aa)[1:2]
chemi_aa_coldf
names(chemi_aa_coldf)[1]<-chemistry
names(chemi_aa_coldf)[1]<-"chemistry"
chemi_aa_coldf
load("D:/R_package/colorscheme2/data/sampleseq.rda")
sampleseq
seq<-sampleseq
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,1]),numeric(1))
scheme_df<-chemi_aa_coldf
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,1]),numeric(1))
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,2]),numeric(1))
y <- rep("white", length(line))
names(y) <- names(line)
col_convert <- vapply(line, function(pos){
y[pos] <- scheme_df[,3][pos] %>% as.character
}, character(1))
seqcolor <- col_convert[seq]
dim(seqcolor) <- dim(seq)
library(dplyr)
y <- rep("white", length(line))
names(y) <- names(line)
col_convert <- vapply(line, function(pos){
y[pos] <- scheme_df[,3][pos] %>% as.character
}, character(1))
seqcolor <- col_convert[seq]
dim(seqcolor) <- dim(seq)
seqcolor
library(devtools)
devtools::use_data(chemi_aa_coldf)
devtools::use_data(chemi_aa_coldf,overwrite = TRUE)
chemi_aa_coldf
names(chemi_aa_coldf)[3]<-"color"
chemi_aa_coldf
scheme_df<-chemi_aa_coldf
scheme_df$color
color_scheme_2 <-function(seq, scheme_df){
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,2]),numeric(1))
##assign color to character in seq_unique
y <- rep("white", length(line))
names(y) <- names(line)
col_convert <- vapply(line, function(pos){
y[pos] <- scheme_df$color[pos] %>% as.character
}, character(1))
seqcolor <- col_convert[seq]
dim(seqcolor) <- dim(seq)
return(seqcolor)
}
color_scheme_2(sampleseq,chemi_aa_coldf)==seqcolor
devtools::use_data(chemi_aa_coldf,overwrite = TRUE)
load("D:/R_package/colorscheme2/data/chemi_aa_coldf.rda")
View(chemi_aa_coldf)
load("D:/R_package/colorscheme2/data/chemi_nucle_coldf.rda")
View(chemi_nucle_coldf)
chemi_nucle_coldf
chemi_aa_coldf
aa<-chemi_aa_coldf[,2:3]
aa
chemi_aa_coldf[,3]<-chemi_aa_coldf[,1]
chemi_aa_coldf
ab<-chemi_aa_coldf[,3]
ab
ab<-chemi_aa_coldf[,1]
ab
aa
chemi_aa_coldf[,1:2]<-aa
chemi_aa_coldf
chemi_aa_coldf[,1]<-aa[,1]
chemi_aa_coldf
11
aa
aa[,1]
chemi_aa_coldf[,1]<-aa[,1]
chemi_aa_coldf
names(chemi_aa_coldf)[1:2]<-names(aa)
chemi_aa_coldf
names(chemi_aa_coldf)[3]<-"chemistry"
chemi_aa_coldf
color_scheme_2 <-function(seq, scheme_df){
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,1]),numeric(1))
##assign color to character in seq_unique
y <- rep("white", length(line))
names(y) <- names(line)
col_convert <- vapply(line, function(pos){
y[pos] <- scheme_df$color[pos] %>% as.character
}, character(1))
seqcolor <- col_convert[seq]
dim(seqcolor) <- dim(seq)
return(seqcolor)
}
color_scheme_2(sampleseq,chemi_aa_coldf)=seqcolor
color_scheme_2(sampleseq,chemi_aa_coldf)==seqcolor
devtools::use_data(chemi_aa_coldf)
devtools::use_data(chemi_aa_coldf,overwrite = T)
load("D:/R_package/colorscheme2/data/chemi_aa_coldf.rda")
View(chemi_aa_coldf)
chemi_aa_coldf
seq1 <- as.matrix(c("A","T","A","G","C","G","C"))
color_scheme_2(seq1, chemi_nucle_coldf)
load("D:/R_package/colorscheme2/data/chemi_nucle_coldf.rda")
chemi_nucle_coldf
names(chemi_nucle_coldf)[2]<-"color"
chemi_nucle_coldf
devtools::use_data(chemi_nucle_coldf)
devtools::use_data(chemi_nucle_coldf,overwrite = T)
load("D:/R_package/colorscheme2/data/chemi_aa_coldf.rda")
chemi_aa_coldf
color_scheme_2(aa_seq, chemi_aa_coldf)
aa_seq<-c("A","F","W","-","R","S","D")
color_scheme_2(aa_seq, chemi_aa_coldf)
color <- c("light blue","light orange","medium salmon","light green","dark grey","white")
nucleotide <- c("A","C","G","T","U","-")
shape_nucle_coldf <- data.frame(nucleotide, color)
shape_nucle_coldf
color <- c("dark grey","blue","cyan","bright red","yellow","light grey","pale blue","green","flesh","orange","purple","white")
amino_acid <- c("A","RK","NQ","DE","CM","G","H","ILV","FY","P","ST","W","-")
length(color)
length(amino_acid)
color[1:5]
color <- c("dark grey","blue","bright red","yellow","light grey","pale blue","green","flesh","orange","purple","white")
color[1:5]
color <- c("dark grey","blue","cyan","bright red","yellow","light grey","pale blue","green","flesh","orange","purple","white")
color[1:5]
color <- c("dark grey","blue","cyan","bright red","yellow","light grey","pale blue","green","mid blue","flesh","orange","purple","white")
amino_acid <- c("A","RK","NQ","DE","CM","G","H","ILV","FY","P","ST","W","-")
length(color)
color[6:10]
color[11:13]
color <- c("dark grey","blue","cyan","bright red","yellow","light grey","pale blue","green","mid blue","flesh","orange","purple","tan")
amino_acid <- c("A","RK","NQ","DE","CM","G","H","ILV","FY","P","ST","W","-")
shape_aa_coldf <- data.frame(amino_acid, color)
shape_aa_coldf
color <- c("light blue","light orange","medium salmon","light green","dark grey","medium purple")
nucleotide <- c("A","C","G","T","U","-")
shape_nucle_coldf <- data.frame(nucleotide, color)
shape_nucle_coldf
devtools::use_data(shape_nucle_coldf)
devtools::use_data(shape_aa_coldf)
seq2<-c("A","C","G","T","-")
shape_nucle_coldf
color <- c("dark grey","blue","cyan","bright red","yellow","light grey","pale blue","green","mid blue","flesh","orange","purple","white")
amino_acid <- c("A","RK","NQ","DE","CM","G","H","ILV","FY","P","ST","W","-")
shape_aa_coldf <- data.frame(amino_acid, color)
color <- c("light blue","light orange","medium salmon","light green","dark grey","white")
nucleotide <- c("A","C","G","T","U","-")
shape_nucle_coldf <- data.frame(nucleotide, color)
devtools::use_data(shape_aa_coldf,overwrite = T)
devtools::use_data(shape_nucle_coldf,overwrite = T)
seq1
seq2
scheme_df<-shape_nucle_coldf
color_scheme_2(seq2,scheme_df)
load("C:/Users/huina/Desktop/color.scheme/data/testseq.rda")
testseq
testseq[,7]<-c("-","-","t","t","t","v","v","v","v")
testseq
devtools::use_data(testseq)
testseqcolor_shape<-color_scheme_2(testseq,shape_aa_coldf)
testseqcolor_shape
testseq
devtools::use_data(testseqcolor_shape)
load("D:/R_package/colorscheme2/data/sampleseqcolor.rda")
sampleseqcolor
sampleseqcolor_chemistry<-sampleseqcolor
devtools::use_data(sampleseqcolor_chemistry)
testseqcolor_chemistry<-color_scheme_2(testseq,chemi_aa_coldf)
testseqcolor_chemistry
testseq
devtools::use_data(testseqcolor_chemistry)
chemi_aa_coldf
chemi_nucle_coldf
load("D:/R_package/colorscheme2/data/shape_aa_coldf.rda")
shape_aa_coldf
load("D:/R_package/colorscheme2/data/shape_nucle_coldf.rda")
shape_nucle_coldf
?roxygen2
library(roxygen2)
?roxygen2
vignette("rd", package = "roxygen2")
roxygen2::roxygenise()
getwd()
setwd("..")
getwd()
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
testseqcolor_chemistry
names(testseq)<-1:7
testseq
table(testseq[,1])
table(testseq[,2])
table(testseq[,3])
table(testseq[,4])
table(testseq[,5])
table(testseq[,6])
table(testseq[,7])
devtools::use_data(testseq,overwrite = T)
load("D:/R_package/colorscheme2/data/testseq.rda")
testseq
names(testseqcolor_chemistry)<-1:7
testseqcolor_chemistry
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
testseqcolor_chemistry
colnames(testseqcolor_chemistry)<-1:7
testseqcolor_chemistry
devtools::use_data(testseqcolor_chemistry,overwrite = T)
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
testseqcolor_chemistry
load("D:/R_package/colorscheme2/data/testseqcolor_shape.rda")
testseqcolor_shape
colnames(testseqcolor_shape)<-1:7
testseqcolor_shape
devtools::use_data(testseqcolor_shape,overwrite = T)
load("D:/R_package/colorscheme2/data/sampleseq.rda")
sampleseq
dim(sampleseq)
names(sampleseq)<-1:9
sampleseq
load("D:/R_package/colorscheme2/data/sampleseq.rda")
names(sampleseq)<-1:20
sampleseq
devtools::use_data(sampleseq,overwrite = T)
load("D:/R_package/colorscheme2/data/sampleseqcolor_chemistry.rda")
n1<-paste("V",1:7,sep="")
n1
load("D:/R_package/colorscheme2/data/testseq.rda")
names(testseq)<-n1
n2<-paste("V",1:20,sep="")
n2
testseq
devtools::use_data(testseq,overwrite = T)
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
names(testseqcolor_chemistry)<-n1
devtools::use_data(testseqcolor_chemistry,overwrite = T)
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
testseqcolor_chemistry
testseqcolor_chemistry<-color_scheme_2(testseq,chemi_aa_coldf)
testseqcolor_chemistry
colnames(testseqcolor_chemistry)<-n1
testseqcolor_chemistry
devtools::use_data(testseqcolor_chemistry,overwrite = T)
colnames(testseqcolor_shape)<-n1
testseqcolor_shape
devtools::use_data(testseqcolor_shape,overwrite = T)
load("D:/R_package/colorscheme2/data/testseqcolor_shape.rda")
testseqcolor_shape
load("D:/R_package/colorscheme2/data/sampleseq.rda")
sampleseq
names(sampleseq)<-n2
sampleseq
devtools::use_data(sampleseq,overwrite = T)
load("D:/R_package/colorscheme2/data/sampleseq.rda")
sampleseq
load("D:/R_package/colorscheme2/data/sampleseq.rda")
sampleseq
load("D:/R_package/colorscheme2/data/sampleseqcolor_chemistry.rda")
sampleseqcolor_chemistry
colnames(sampleseqcolor_chemistry)<-n2
sampleseqcolor_chemistry
devtools::use_data(sampleseqcolor_chemistry,overwrite = T)
load("D:/R_package/colorscheme2/data/sampleseqcolor_chemistry.rda")
sampleseqcolor_chemistry
load("D:/R_package/colorscheme2/data/testseq.rda")
testseq
load("D:/R_package/colorscheme2/data/testseqcolor_chemistry.rda")
testseqcolor_chemistry
load("D:/R_package/colorscheme2/data/testseqcolor_shape.rda")
testseqcolor_shape
roxygen2::roxygenise()
shape_nucle_coldf
devtools::test()
color_scheme_2 <-function(seq, scheme_df){
seq <- toupper(as.matrix(seq))    ##make sure the suquence is capital format
seq_unique <- unique(unlist(as.list(seq)))  ##remain the unique character in seq and save them in seq_unique
##get the matched lines of each character of seq_unique in scheme_df
line <- vapply(seq_unique, function(aa) i <- grep(aa,scheme_df[,1]),numeric(1))
##assign color to character in seq_unique
y <- rep("white", length(line))
names(y) <- names(line)
col_convert <- vapply(line, function(pos){
y[pos] <- scheme_df$color[pos] %>% as.character
}, character(1))
seqcolor <- col_convert[seq]
dim(seqcolor) <- dim(seq)
return(seqcolor)
}
shape_seq <- as.matrix(c("A","T","A","G","C","G","-"))
color_scheme_2(shape_seq,shape_nucle_coldf)
shape_seqcolor <-c("light blue","light green","light blue","medium salmon","light orange","medium salmon","white")
color_scheme_2(shape_seq,shape_nucle_coldf)==shape_seqcolor
shape_aa_seq<-c("A","F","W","-","R","S","D")
color_scheme_2(shape_aa_seq, shape_aa_coldf)
color_scheme_2(shape_aa_seq, shape_aa_coldf)==shape_aa_seqcolor
shape_aa_seqcolor<-c("orange","yellow","yellow","white","blue","green","pink")
color_scheme_2(shape_aa_seq, shape_aa_coldf)==shape_aa_seqcolor
shape_aa_coldf
shape_aa_seqcolor<-c("dark grey","mid blue","purple","white","blue","orange","bright red")
color_scheme_2(shape_aa_seq, shape_aa_coldf)==shape_aa_seqcolor
devtools::test()
devtools::test()
amino_acid <- c("A","R","N","D","C","E","Q","G","H","IL","K","M","F","P","S","T","W","Y","V")
length(amino_acid)
color<-c("lemon","blue","purple","red","yellow","violet","magenta","orange","peacock","green","indigo","green","emerald","tangerine","scarlet","vermillion","cyan","turquoise","lemon-lime","white")
length(color)
color<-c("lemon","blue","purple","red","yellow","violet","magenta","orange","peacock","green","indigo","green","emerald","tangerine","scarlet","vermillion","cyan","turquoise","lemon-lime","white")
amino_acid <- c("A","R","N","D","C","E","Q","G","H","IL","K","M","F","P","S","T","W","Y","V","-")
Taylor_nucle_coldf <- data.frame(nucleotide, color)
color<-c("lemon","blue","purple","red","yellow","violet","magenta","orange","peacock","green","indigo","green","emerald","tangerine","scarlet","vermillion","cyan","turquoise","lemon-lime","white")
amino_acid <- c("A","R","N","D","C","E","Q","G","H","IL","K","M","F","P","S","T","W","Y","V","-")
Taylor_aa_coldf <- data.frame(amino_acid, color)
Taylor_aa_coldf
devtools::use_data(Taylor_aa_coldf)
color<-c("lemon","blue","purple","red","yellow","violet","magenta","orange","peacock","lime-grass","indigo","green","emerald","tangerine","scarlet","vermillion","cyan","turquoise","lemon-lime","white")
amino_acid <- c("A","R","N","D","C","E","Q","G","H","IL","K","M","F","P","S","T","W","Y","V","-")
Taylor_aa_coldf <- data.frame(amino_acid, color)
devtools::use_data(Taylor_aa_coldf,overwrite = T)
color<-c("lime-grass","yellow","purple","red","white")
nucleotide <- c("A","C","G","TU","-")
Taylor_nucle_coldf <- data.frame(nucleotide, color)
Taylor_nucle_coldf
devtools::use_data(Taylor_nucle_coldf)
load("D:/R_package/colorscheme2/data/shape_nucle_coldf.rda")
shape_nucle_coldf
color<-c("salmon","orange","blue","red","green","purple","yellow","white")
amino_acid <- c("ILVAM","FWY","KRH","DE","STNQ","PG","C","-")
Zappo_aa_coldf <- data.frame(amino_acid, color)
Zappo_aa_coldf
color<-c("salmon","orange","blue","red","green","purple","yellow","white")
amino_acid <- c("ILVAM","FWY","KRH","DE","STNQ","PG","C","-")
physicochemical_properties <- c("Aliphatic/hydrophobic","Aromatic","Positive","Negative","Hydrophilic","conformationally special","Cysteine","none")
Zappo_aa_coldf <- data.frame(amino_acid, color, physicochemical_properties)
Zappo_aa_coldf
devtools::use_data(Zappo_aa_coldf)
shape_aa_coldf
color <- c("red","carnatio","purple","blue","white","white")
nucleotide <- c("A","C","G","T","U","-")
Zappo_nucle_coldf <- data.frame(nucleotide, color)
Zappo_nucle_coldf
devtools::use_data(Zappo_nucle_coldf)
load("D:/R_package/colorscheme2/data/Zappo_aa_coldf.rda")
Zappo_aa_coldf
testseqcolor_Zappo<-color_scheme_2(testseq,Zappo_aa_coldf)
testseqcolor_Zappo
testseq
View(Zappo_aa_coldf)
colnames(testseqcolor_Zappo)<-n1
testseqcolor_Zappo
devtools::use_data(testseqcolor_Zappo)
testseqcolor_Taylor<-color_scheme_2(testseq,Taylor_aa_coldf)
testseqcolor_Taylor
load("D:/R_package/colorscheme2/data/Taylor_aa_coldf.rda")
View(Taylor_aa_coldf)
testseq
colnames(testseqcolor_Taylor)<-n1
testseqcolor_Taylor
devtools::use_data(testseqcolor_Taylor)
load("D:/R_package/colorscheme2/data/Taylor_aa_coldf.rda")
load("D:/R_package/colorscheme2/data/testseqcolor_Taylor.rda")
load("D:/R_package/colorscheme2/data/testseqcolor_Zappo.rda")
testseqcolor_Taylor
roxygen2::roxygenise()
load("D:/R_package/colorscheme2/data/Taylor_aa_coldf.rda")
load("D:/R_package/colorscheme2/data/Taylor_nucle_coldf.rda")
Taylor_nucle_coldf
Taylor_nucle_coldf
Taylor_aa_coldf
load("D:/R_package/colorscheme2/data/Zappo_aa_coldf.rda")
Zappo_aa_coldf
load("D:/R_package/colorscheme2/data/Zappo_nucle_coldf.rda")
Zappo_nucle_coldf
devtools::test()
